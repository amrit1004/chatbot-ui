(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48312:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return l(81533)}])},81533:function(e,t,l){"use strict";l.r(t),l.d(t,{__N_SSG:function(){return eX},default:function(){return eV}});var s,r,a=l(85893),n=l(67294),i=l(61162),o=l(9008),d=l.n(o);let c=e=>{let{initialState:t}=e,l=(e,l)=>{if(!l.type)return{...e,[l.field]:l.value};if("reset"===l.type)return t;throw Error()},[s,r]=(0,n.useReducer)(l,t);return(0,n.useMemo)(()=>({state:s,dispatch:r}),[s,r])};var u=l(83454);let m=()=>{let e=async e=>{let t="".concat(e.url,"/v1/models"),l=await fetch(t,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.key?e.key:u.env.OPENAI_API_KEY)}}),s=await l.json(),r=s.data;return r&&r.length>0?r.map(e=>(-1===e.id.indexOf(":")||e.name||(e.name=e.id.split(":")[1],e.id=e.id.split(":")[0]),e)):[]};return{getModels:e}};(s=r||(r={})).GPT_3_5="gpt-3.5-turbo",s.LLAMA_2_CHAT="llama-2-chat",s.GPT_3_5_AZ="gpt-35-turbo",s.GPT_4="gpt-4",s.GPT_4_32K="gpt-4-32k",r.LLAMA_2_CHAT;let x={[r.GPT_3_5]:{id:r.GPT_3_5,name:"GPT-3.5",maxLength:12e3,tokenLimit:4e3},[r.LLAMA_2_CHAT]:{id:r.LLAMA_2_CHAT,name:"LLAMA_2_CHAT",maxLength:12e3,tokenLimit:4e3},[r.GPT_3_5_AZ]:{id:r.GPT_3_5_AZ,name:"GPT-3.5",maxLength:12e3,tokenLimit:4e3},[r.GPT_4]:{id:r.GPT_4,name:"GPT-4",maxLength:24e3,tokenLimit:8e3},[r.GPT_4_32K]:{id:r.GPT_4_32K,name:"GPT-4-32K",maxLength:96e3,tokenLimit:32e3}};var p=l(83454);p.env.NEXT_PUBLIC_DEFAULT_SYSTEM_PROMPT,p.env.OPENAI_API_HOST;let h=parseFloat(p.env.NEXT_PUBLIC_DEFAULT_TEMPERATURE||"1");p.env.OPENAI_API_TYPE,p.env.OPENAI_API_VERSION,p.env.OPENAI_ORGANIZATION,p.env.AZURE_DEPLOYMENT_ID;let g=e=>{let t=e;return t.model||(t={...t,model:t.model||x[r.GPT_3_5]}),t.temperature||(t={...t,temperature:t.temperature||h}),t.folderId||(t={...t,folderId:t.folderId||null}),t.messages||(t={...t,messages:t.messages||[]}),t},f=e=>Array.isArray(e)?e.reduce((e,t)=>{try{t.model||(t.model=x[r.GPT_3_5]),t.temperature||(t.temperature=h),t.folderId||(t.folderId=null),t.messages||(t.messages=[]),e.push(t)}catch(e){console.warn("error while cleaning conversations' history. Removing culprit",e)}return e},[]):(console.warn("history is not an array. Returning an empty array."),[]),v=(e,t)=>{let l=t.map(t=>t.id===e.id?e:t);return b(e),w(l),{single:e,all:l}},b=e=>{localStorage.setItem("selectedConversation",JSON.stringify(e))},w=e=>{localStorage.setItem("conversationHistory",JSON.stringify(e))},j=e=>{localStorage.setItem("folders",JSON.stringify(e))},y=e=>{localStorage.setItem("prompts",JSON.stringify(e))},N="settings",k=()=>{let e={theme:"dark",isStream:!0},t=localStorage.getItem(N);if(t)try{let l=JSON.parse(t);e=Object.assign(e,l)}catch(e){console.error(e)}return e},C=e=>{localStorage.setItem(N,JSON.stringify(e))},S=async(e,t,l,s,r,a)=>{let n;n=t?[{role:"system",content:t},...a]:a;let i=await fetch("".concat(s,"/v1/chat/completions"),{headers:{accept:"application/json","Content-Type":"text/event-stream"},method:"POST",body:JSON.stringify({model:e.id,messages:n,stream:!0,stream_options:{include_usage:!0}})});return i.body},L=async(e,t,l,s,r,a)=>{let n=await fetch("".concat(s,"/v1/chat/completions"),{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({model:e.id,messages:[{role:"system",content:t},...a],stream:!1})});return await n.json()},I=(0,n.createContext)(void 0);var E=l(59348),_=l(63072);let P=e=>{let{prompts:t,activePromptIndex:l,onSelect:s,onMouseOver:r,promptListRef:n}=e;return(0,a.jsx)("ul",{ref:n,className:"z-10 max-h-52 w-full overflow-scroll rounded border border-black/10 bg-white shadow-[0_0_10px_rgba(0,0,0,0.10)] dark:border-neutral-500 dark:bg-[#343541] dark:text-white dark:shadow-[0_0_15px_rgba(0,0,0,0.10)]",children:t.map((e,t)=>(0,a.jsx)("li",{className:"".concat(t===l?"bg-gray-200 dark:bg-[#202123] dark:text-black":""," cursor-pointer px-3 py-2 text-sm text-black dark:text-white"),onClick:e=>{e.preventDefault(),e.stopPropagation(),s()},onMouseEnter:()=>r(t),children:e.name},e.id))})},A=e=>{let{prompt:t,variables:l,onSubmit:s,onClose:r}=e,[i,o]=(0,n.useState)(l.map(e=>({key:e,value:""})).filter((e,t,l)=>l.findIndex(t=>t.key===e.key)===t)),d=(0,n.useRef)(null),c=(0,n.useRef)(null),u=(e,t)=>{o(l=>{let s=[...l];return s[e].value=t,s})},m=()=>{if(i.some(e=>""===e.value)){alert("Please fill out all variables");return}s(i.map(e=>e.value)),r()},x=e=>{"Enter"!==e.key||e.shiftKey?"Escape"===e.key&&r():(e.preventDefault(),m())};return(0,n.useEffect)(()=>{let e=e=>{d.current&&!d.current.contains(e.target)&&r()};return window.addEventListener("click",e),()=>{window.removeEventListener("click",e)}},[r]),(0,n.useEffect)(()=>{c.current&&c.current.focus()},[]),(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onKeyDown:x,children:(0,a.jsxs)("div",{ref:d,className:"dark:border-netural-400 inline-block max-h-[400px] transform overflow-y-auto rounded-lg border border-gray-300 bg-white px-4 pt-5 pb-4 text-left align-bottom shadow-xl transition-all dark:bg-[#202123] sm:my-8 sm:max-h-[600px] sm:w-full sm:max-w-lg sm:p-6 sm:align-middle",role:"dialog",children:[(0,a.jsx)("div",{className:"mb-4 text-xl font-bold text-black dark:text-neutral-200",children:t.name}),(0,a.jsx)("div",{className:"mb-4 text-sm italic text-black dark:text-neutral-200",children:t.description}),i.map((e,t)=>(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("div",{className:"mb-2 text-sm font-bold text-neutral-200",children:e.key}),(0,a.jsx)("textarea",{ref:0===t?c:void 0,className:"mt-1 w-full rounded-lg border border-neutral-500 px-4 py-2 text-neutral-900 shadow focus:outline-none dark:border-neutral-800 dark:border-opacity-50 dark:bg-[#40414F] dark:text-neutral-100",style:{resize:"none"},placeholder:"Enter a value for ".concat(e.key,"..."),value:e.value,onChange:e=>u(t,e.target.value),rows:3})]},t)),(0,a.jsx)("button",{className:"mt-6 w-full rounded-lg border border-neutral-500 px-4 py-2 text-neutral-900 shadow hover:bg-neutral-100 focus:outline-none dark:border-neutral-800 dark:border-opacity-50 dark:bg-white dark:text-black dark:hover:bg-neutral-300",onClick:m,children:"Submit"})]})})},T=e=>{var t;let{onSend:l,onRegenerate:s,maxImg:r,onScrollDownClick:o,stopConversationRef:d,textareaRef:c,showScrollDownButton:u}=e,{t:m}=(0,i.$G)("chat"),{state:{selectedConversation:x,messageIsStreaming:p,prompts:h},dispatch:g}=(0,n.useContext)(I),[f,v]=(0,n.useState)(),[b,w]=(0,n.useState)(!1),[j,y]=(0,n.useState)(!1),[N,k]=(0,n.useState)(0),[C,S]=(0,n.useState)(""),[L,T]=(0,n.useState)([]),[z,D]=(0,n.useState)(!1),[O,F]=(0,n.useState)(!1),[Z,R]=(0,n.useState)(null),[G,M]=(0,n.useState)(!1),[K,U]=(0,n.useState)(""),J=(0,n.useRef)(null),H=h.filter(e=>e.name.toLowerCase().includes(C.toLowerCase())),B=e=>{let t=e.target.value,l=null==x?void 0:x.model.maxLength;if(l&&t.length>l){alert(m("Message limit is {{maxLength}} characters. You have entered {{valueLength}} characters.",{maxLength:l,valueLength:t.length}));return}v(t),q(t)},$=()=>{let e=et;if(G&&(e=en()),p)return;if(!f){alert(m("Please enter a message"));return}let t=f;e.length>0&&(t=[{type:"text",text:f}],e.forEach(e=>{Array.isArray(t)&&t.push({type:"image_url",image_url:{url:e}})})),l({role:"user",content:t},Z),v(""),el([]),R(null),window.innerWidth<640&&c&&c.current&&c.current.blur()},W=()=>{let e=void 0===window.navigator?"":navigator.userAgent;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(e)},Y=()=>{let e=H[N];e&&(v(t=>null==t?void 0:t.replace(/\/\w*$/,e.content)),Q(e)),y(!1)},V=e=>{j?"ArrowDown"===e.key?(e.preventDefault(),k(e=>e<h.length-1?e+1:e)):"ArrowUp"===e.key?(e.preventDefault(),k(e=>e>0?e-1:e)):"Tab"===e.key?(e.preventDefault(),k(e=>e<h.length-1?e+1:0)):"Enter"===e.key?(e.preventDefault(),Y()):"Escape"===e.key?(e.preventDefault(),y(!1)):k(0):"Enter"!==e.key||b||W()||e.shiftKey?"/"===e.key&&e.metaKey&&(e.preventDefault(),F(!O)):(e.preventDefault(),$())},X=e=>{let t;let l=/{{(.*?)}}/g,s=[];for(;null!==(t=l.exec(e));)s.push(t[1]);return s},q=(0,n.useCallback)(e=>{let t=e.match(/\/\w*$/);t?(y(!0),S(t[0].slice(1))):(y(!1),S(""))},[]),Q=e=>{let t=X(e.content);T(t),t.length>0?D(!0):(v(t=>null==t?void 0:t.replace(/\/\w*$/,e.content)),q(e.content))},ee=e=>{let t=null==f?void 0:f.replace(/{{(.*?)}}/g,(t,l)=>{let s=L.indexOf(l);return e[s]});v(t),c&&c.current&&c.current.focus()};(0,n.useEffect)(()=>{J.current&&(J.current.scrollTop=30*N)},[N]),(0,n.useEffect)(()=>{if(c&&c.current){var e,t;c.current.style.height="inherit",c.current.style.height="".concat(null===(e=c.current)||void 0===e?void 0:e.scrollHeight,"px"),c.current.style.overflow="".concat((null==c?void 0:null===(t=c.current)||void 0===t?void 0:t.scrollHeight)>400?"auto":"hidden")}},[f]),(0,n.useEffect)(()=>{let e=e=>{J.current&&!J.current.contains(e.target)&&y(!1)};return window.addEventListener("click",e),()=>{window.removeEventListener("click",e)}},[]);let[et,el]=(0,n.useState)([]),es=e=>{let t=e.target.files;if(t){let e=[],l=[];for(let s=0;s<t.length;s++){let r=t[s],a=new FileReader;l.push(new Promise(t=>{a.onloadend=()=>{e.push(a.result),t()}})),a.readAsDataURL(r)}Promise.all(l).then(()=>{er(e)})}},er=e=>{let t;if(et.length+e.length<=r)t=[...et,...e];else{let l=[...e,...e];t=l.slice(-r)}return el(t),t},ea=e=>{el(t=>{let l=[...t];return l.splice(e,1),l})},en=()=>{let e=[];return M(!1),K&&(e=er([K]),U("")),e};return(0,a.jsxs)("div",{className:"absolute bottom-0 left-0 w-full  pt-6 bg-white ",children:[(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:es,style:{display:"none"},id:"upload-button"}),(0,a.jsx)("div",{className:"lg:mx-auto lg:max-w-3xl mx-2 md:mx-4  ",children:(0,a.jsx)("div",{className:"flex justify-start"+(et.length>0?" mt-4":""),children:(0,a.jsxs)("div",{className:"text-black flex items-center p-2 mx-2 sm:mx-4 w-full rounded-t-md bg-white border-black/10  border-t border-x",children:[(0,a.jsx)("button",{title:"upload image file",disabled:0===r,className:"p-2 mr-2 bg-[#F7F7F7] rounded-lg"+(0===r?" cursor-not-allowed":""),onClick:()=>{var e;null===(e=document.getElementById("upload-button"))||void 0===e||e.click()},children:(0,a.jsx)("img",{style:{width:"20px",height:"20px"},src:"./icons/icon-upload.svg",alt:""})}),G?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{onChange:e=>{U(e.target.value)},id:"imgUrlInputBox",autoFocus:!0,style:{height:"2.25rem"},className:"px-2 h-full bg-[#ffffff] border-l border-t border-b outline-none rounded-l-lg"}),(0,a.jsx)("button",{title:"upload",className:"p-2 bg-[#F7F7F7]  rounded-r-lg",onClick:en,children:K?"Submit":"Close"})]}):(0,a.jsx)("button",{disabled:0===r,title:"Upload images by entering the url",className:"p-2 bg-[#F7F7F7] rounded-lg"+(0===r?" cursor-not-allowed":""),onClick:()=>{M(!0)},children:(0,a.jsx)("img",{style:{width:"20px",height:"20px"},src:"./icons/icon-link.svg",alt:""})}),(0,a.jsx)("div",{className:"ml-4 "+(0===r?"block":"hidden"),children:"For Llava series models, please submit an image URL for processing first."})]})})}),(0,a.jsx)("div",{className:"stretch mx-2 flex flex-row gap-3 last:mb-2 md:mx-4 md:last:mb-6 lg:mx-auto lg:max-w-3xl",children:(0,a.jsxs)("div",{className:"relative mx-2 flex w-full flex-grow flex-col rounded-b-md border  bg-white sm:mx-4",children:[(0,a.jsx)("div",{className:"absolute left-2 top-2 rounded-sm p-1 ",children:(0,a.jsx)(E.Z,{size:20,color:"#989898"})}),(0,a.jsx)("textarea",{ref:c,className:"m-0 w-full resize-none border-0 rounded-r-lg rounded-l-lg outline-none bg-white p-0 py-2  pr-20 md:pr-8 pl-10 text-black md:py-3 md:pl-10 h-[56px] md:h-auto",style:{resize:"none",bottom:"".concat(null==c?void 0:null===(t=c.current)||void 0===t?void 0:t.scrollHeight,"px"),maxHeight:"400px",overflow:"".concat(c.current&&c.current.scrollHeight>400?"auto":"hidden")},placeholder:m('Type a message or type "/" to select a prompt...')||"",value:f,rows:1,onCompositionStart:()=>w(!0),onCompositionEnd:()=>w(!1),onChange:B,onKeyDown:V}),(0,a.jsx)("button",{className:"absolute right-2 top-2 rounded-sm p-1 inline-flex items-center gap-2 cursor-pointer",onClick:$,children:p?(0,a.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-t-2 border-neutral-800  "}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("img",{style:{width:"18px",height:"18px"},src:"./icons/icon-send.svg",alt:""}),(0,a.jsx)("p",{className:"text-xs font-bold text-[#989898] uppercase",children:"Send"})]})}),u&&(0,a.jsx)("div",{className:"absolute bottom-12 right-0 lg:bottom-0 lg:-right-10",children:(0,a.jsx)("button",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-neutral-300 text-gray-800 shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-neutral-200",onClick:o,children:(0,a.jsx)(_.Z,{size:18})})}),j&&H.length>0&&(0,a.jsx)("div",{className:"absolute bottom-12 w-full",children:(0,a.jsx)(P,{activePromptIndex:N,prompts:H,onSelect:Y,onMouseOver:k,promptListRef:J})}),z&&(0,a.jsx)(A,{prompt:H[N],variables:L,onSubmit:ee,onClose:()=>D(!1)})]})}),(0,a.jsx)("div",{className:"lg:mx-auto lg:max-w-3xl",children:(0,a.jsx)("div",{className:"flex mx-2 sm:mx-4"+(et.length>0?" mt-4":""),children:et.map((e,t)=>(0,a.jsx)("div",{style:{position:"relative",display:"inline-block",marginRight:"10px"},children:(0,a.jsxs)("div",{style:{width:"100px",height:"100px",borderRadius:"5px",border:"1px dashed #ccc",overflow:"hidden",position:"relative"},children:[(0,a.jsx)("img",{src:e,alt:"Uploaded",style:{width:"100%",height:"100%",objectFit:"cover"}}),(0,a.jsx)("div",{style:{position:"absolute",top:"5px",right:"5px",cursor:"pointer"},onClick:()=>ea(t),children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-x-circle",viewBox:"0 0 16 16",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zM7.354 8l-2.88 2.879a.5.5 0 0 1-.708-.708L6.646 8 3.766 5.121a.5.5 0 0 1 .708-.708L8 7.354l2.879-2.88a.5.5 0 0 1 .708.708L8.354 8l2.879 2.879a.5.5 0 0 1-.708.708L8 8.354 5.121 11.233a.5.5 0 0 1-.708-.708L7.354 8z"})})})]})},t))})}),(0,a.jsxs)("div",{className:"px-3 pt-2 pb-3 text-center text-[12px] text-black/50 md:px-4 md:pt-3 md:pb-6",children:[(0,a.jsx)("span",{children:"Based on "}),(0,a.jsx)("a",{href:"https://github.com/GaiaNet-AI/chatbot-ui",target:"_blank",rel:"noreferrer",className:"underline",children:"chatbot-ui"})]})]})},z=()=>(0,a.jsx)("div",{className:"group  bg-white text-gray-800 ",style:{overflowWrap:"anywhere"},children:(0,a.jsx)("div",{className:"m-auto flex gap-4 p-4 text-base md:max-w-2xl md:gap-6 md:py-6 lg:max-w-2xl lg:px-0 xl:max-w-3xl",children:(0,a.jsxs)("div",{className:"mx-2 flex w-full   bg-white sm:mx-4 gap-6",children:[(0,a.jsx)("div",{className:"min-w-[40px] items-end",children:(0,a.jsx)("img",{style:{width:"32px",height:"32px"},src:"./icons/icon-bot.svg",alt:""})}),(0,a.jsx)("span",{className:"animate-pulse cursor-default mt-1",children:"▍"})]})})});var D=l(21942),O=l(74075),F=l(24888),Z=l(88198),R=l(93625),G=l(67828),M=l(80335),K=l(93179),U=l(84283);let J={javascript:".js",python:".py",java:".java",c:".c",cpp:".cpp","c++":".cpp","c#":".cs",ruby:".rb",php:".php",swift:".swift","objective-c":".m",kotlin:".kt",typescript:".ts",go:".go",perl:".pl",rust:".rs",scala:".scala",haskell:".hs",lua:".lua",shell:".sh",sql:".sql",html:".html",css:".css"},H=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l="ABCDEFGHJKLMNPQRSTUVWXY3456789",s="";for(let t=0;t<e;t++)s+=l.charAt(Math.floor(Math.random()*l.length));return t?s.toLowerCase():s},B=(0,n.memo)(e=>{let{language:t,value:l}=e,{t:s}=(0,i.$G)("markdown"),[r,o]=(0,n.useState)(!1),d=()=>{navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(l).then(()=>{o(!0),setTimeout(()=>{o(!1)},2e3)})},c=()=>{let e=J[t]||".file",r="file-".concat(H(3,!0)).concat(e),a=window.prompt(s("Enter file name")||"",r);if(!a)return;let n=new Blob([l],{type:"text/plain"}),i=URL.createObjectURL(n),o=document.createElement("a");o.download=a,o.href=i,o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)};return(0,a.jsxs)("div",{className:"codeblock relative font-sans text-[16px]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between py-1.5 px-4",children:[(0,a.jsx)("span",{className:"text-xs lowercase text-white",children:t}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("button",{className:"flex gap-1.5 items-center rounded bg-none p-1 text-xs text-white",onClick:d,children:[r?(0,a.jsx)(Z.Z,{size:18}):(0,a.jsx)(G.Z,{size:18}),r?s("Copied!"):s("Copy code")]}),(0,a.jsx)("button",{className:"flex items-center rounded bg-none p-1 text-xs text-white",onClick:c,children:(0,a.jsx)(M.Z,{size:18})})]})]}),(0,a.jsx)(K.Z,{language:t,style:U.vk,customStyle:{margin:0},children:l})]})});B.displayName="CodeBlock";var $=l(97495);let W=(0,n.memo)($.D,(e,t)=>e.children===t.children);var Y=l(69232),V=l(14769),X=l(30399);let q=(0,n.memo)(e=>{var t;let{message:l,maxImg:s,messageIndex:r,onRegenerate:o,onEdit:d}=e,{t:c}=(0,i.$G)("chat"),{state:{selectedConversation:u,conversations:m,currentMessage:x,messageIsStreaming:p},dispatch:h}=(0,n.useContext)(I),[g,f]=(0,n.useState)(!1),[b,w]=(0,n.useState)(!1),[j,y]=(0,n.useState)(""),[N,k]=(0,n.useState)([]),[C,S]=(0,n.useState)(!1),L=(0,n.useRef)(null),E=()=>{f(!g)},_=e=>{y(e.target.value),L.current&&(L.current.style.height="inherit",L.current.style.height="".concat(L.current.scrollHeight,"px"))},P=()=>{let e=!1,t=!1,s=j,r=z(l.content);N.length>0?((0===r.imgList.length||N.length!==r.imgList.length)&&(t=!0),r.text!==j&&(e=!0),s=[{type:"text",text:j}],N.forEach((e,l)=>{t||e===r.imgList[l]||(t=!0),Array.isArray(s)&&s.push({type:"image_url",image_url:{url:e}})})):(r.imgList.length>0&&(t=!0),l.content!=j&&(e=!0)),(e||t)&&u&&d&&d({...l,content:s}),f(!1)},A=()=>{if(!u)return;let{messages:e}=u,t=e.findIndex(e=>e===l);if(t<0)return;t<e.length-1&&"assistant"===e[t+1].role?e.splice(t,2):e.splice(t,1);let s={...u,messages:e},{single:r,all:a}=v(s,m);h({field:"selectedConversation",value:r}),h({field:"conversations",value:a})},T=e=>{"Enter"!==e.key||b||e.shiftKey||(e.preventDefault(),P())},z=e=>{let t="",l=[];return Array.isArray(e)?e.forEach(e=>{"text"===e.type?t=e.text||"":"image_url"===e.type&&e.image_url&&l.push(e.image_url.url)}):t=e,{text:t,imgList:l}},G=()=>{navigator.clipboard&&navigator.clipboard.writeText(z(l.content).text).then(()=>{S(!0),setTimeout(()=>{S(!1)},2e3)})},M=e=>{let t=z(e);k(t.imgList),y(t.text)};(0,n.useEffect)(()=>{M(l.content)},[l.content]),(0,n.useEffect)(()=>{L.current&&(L.current.style.height="inherit",L.current.style.height="".concat(L.current.scrollHeight,"px"))},[g]);let K=e=>{N.length+e.length<=s?k(t=>[...t,...e]):k(t=>{let l=[...t,...e];return l.slice(-s)})},U=e=>{let t=e.target.files;if(t){let e=[],l=[];for(let s=0;s<t.length;s++){let r=t[s],a=new FileReader;l.push(new Promise(t=>{a.onloadend=()=>{e.push(a.result),t()}})),a.readAsDataURL(r)}Promise.all(l).then(()=>{K(e)})}},J=e=>{k(t=>{let l=[...t];return l.splice(e,1),l})};return(0,a.jsx)("div",{className:"group md:px-4 bg-white text-gray-800 ",style:{overflowWrap:"anywhere"},children:(0,a.jsx)("div",{className:"relative m-auto flex p-4 text-base md:max-w-2xl md:gap-6 lg:max-w-2xl lg:px-0 xl:max-w-3xl",children:(0,a.jsxs)("div",{className:"mx-2 flex w-full   bg-white sm:mx-4 gap-6",children:["assistant"===l.role?(0,a.jsx)("img",{style:{width:"32px",height:"32px"},src:"./icons/icon-bot.svg",alt:""}):(0,a.jsx)("img",{style:{width:"32px",height:"32px"},src:"./icons/icon-user.svg",alt:""}),(0,a.jsx)("div",{className:"border-b boder-[rgba(0,0,0,.08)] pb-5 flex-1 ",children:"user"===l.role?(0,a.jsxs)("div",{className:"flex w-full",children:[g?(0,a.jsxs)("div",{className:"flex w-full flex-col",children:[(0,a.jsx)("textarea",{ref:L,className:"w-full resize-none whitespace-pre-wrap border-none dark:bg-[#343541]",value:j,onChange:_,onKeyDown:T,onCompositionStart:()=>w(!0),onCompositionEnd:()=>w(!1),style:{fontFamily:"inherit",fontSize:"inherit",lineHeight:"inherit",padding:"0",margin:"0",overflow:"hidden"}}),(0,a.jsxs)("div",{className:"flex",children:[N.map((e,t)=>(0,a.jsx)("div",{style:{position:"relative",display:"inline-block",marginRight:"10px"},children:(0,a.jsxs)("div",{style:{width:"100px",height:"100px",borderRadius:"5px",border:"1px dashed #ccc",overflow:"hidden",position:"relative"},children:[(0,a.jsx)("img",{src:e,alt:"Uploaded",className:"my-0",style:{width:"100%",height:"100%",objectFit:"cover"}}),(0,a.jsx)("div",{style:{position:"absolute",top:"5px",right:"5px",cursor:"pointer"},onClick:()=>J(t),children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-x-circle",viewBox:"0 0 16 16",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zM7.354 8l-2.88 2.879a.5.5 0 0 1-.708-.708L6.646 8 3.766 5.121a.5.5 0 0 1 .708-.708L8 7.354l2.879-2.88a.5.5 0 0 1 .708.708L8.354 8l2.879 2.879a.5.5 0 0 1-.708.708L8 8.354 5.121 11.233a.5.5 0 0 1-.708-.708L7.354 8z"})})})]})},t)),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:U,style:{display:"none"},id:"upload-button"}),(0,a.jsx)("div",{style:{width:"100px",height:"100px",borderRadius:"5px",border:"1px dashed #ccc",overflow:"hidden",cursor:"pointer",textAlign:"center",lineHeight:"100px"},className:"flex justify-center items-center"+(N.length>=s?" hidden":""),onClick:()=>{var e;null===(e=document.getElementById("upload-button"))||void 0===e||e.click()},children:(0,a.jsx)("div",{className:"text-4xl",children:"+"})})]}),(0,a.jsxs)("div",{className:"mt-10 flex justify-center space-x-4",children:[(0,a.jsx)("button",{className:"h-[40px] rounded-md bg-blue-500 px-4 py-1 text-sm font-medium text-white enabled:hover:bg-blue-600 disabled:opacity-50",onClick:P,disabled:j.trim().length<=0,children:c("Save & Submit")}),(0,a.jsx)("button",{className:"h-[40px] rounded-md border border-neutral-300 px-4 py-1 text-sm font-medium text-neutral-700 hover:bg-neutral-100 dark:border-neutral-700 dark:text-neutral-300 dark:hover:bg-neutral-800",onClick:()=>{M(l.content),f(!1)},children:c("Cancel")})]})]}):(0,a.jsxs)("div",{className:"prose whitespace-pre-wrap flex-1 text-[#696868]",children:[z(l.content).text,(0,a.jsx)("div",{className:"flex items-center",children:z(l.content).imgList.map((e,t)=>(0,a.jsx)("div",{style:{marginRight:"10px",flex:1},children:(0,a.jsx)("img",{src:e,alt:"Uploaded"})},t))})]}),!g&&(0,a.jsxs)("div",{className:"md:-mr-8 ml-1 md:ml-0 flex flex-col md:flex-row gap-4 md:gap-1 items-center md:items-start justify-end md:justify-start",children:[(0,a.jsx)("button",{className:"invisible group-hover:visible focus:visible text-gray-500 hover:text-[#322221] ",onClick:E,children:(0,a.jsx)(D.Z,{size:18})}),(0,a.jsx)("button",{className:"invisible group-hover:visible focus:visible text-gray-500 hover:text-[#322221] ",onClick:A,children:(0,a.jsx)(O.Z,{size:18})})]})]}):(0,a.jsxs)("div",{className:"flex flex-row",children:[(0,a.jsx)(W,{className:"dark:prose-invert flex-1 text-[#222228] ReactMarkdown",remarkPlugins:[V.Z,X.Z],rehypePlugins:[Y.Z],components:{code(e){let{node:t,inline:l,className:s,children:r,...n}=e;if(r.length){if("▍"==r[0])return(0,a.jsx)("span",{className:"animate-pulse cursor-default mt-1",children:"▍"});r[0]=r[0].replace("`▍`","▍")}let i=/language-(\w+)/.exec(s||"");return l?(0,a.jsx)("code",{className:s,...n,children:r}):(0,a.jsx)(B,{language:i&&i[1]||"",value:String(r).replace(/\n$/,""),...n},Math.random())},table(e){let{children:t}=e;return(0,a.jsx)("table",{className:"border-collapse border border-black px-3 py-1 ",children:t})},th(e){let{children:t}=e;return(0,a.jsx)("th",{className:"break-words border border-black  px-3 py-1 text-white ",children:t})},td(e){let{children:t}=e;return(0,a.jsx)("td",{className:"break-words border border-black px-3 py-1 ",children:t})}},children:"".concat(l.content).concat(p&&r==(null!==(t=null==u?void 0:u.messages.length)&&void 0!==t?t:0)-1?"`▍`":"")}),(0,a.jsxs)("div",{className:"md:-mr-8 ml-1 md:ml-0 flex flex-col md:flex-row gap-4 md:gap-1 items-center md:items-start justify-end md:justify-start",children:[(0,a.jsx)("button",{className:"invisible group-hover:visible focus:visible text-gray-500 hover:text-[#322221]",onClick:o,children:(0,a.jsx)(F.Z,{size:18})}),C?(0,a.jsx)(Z.Z,{size:18,className:"text-green-500 dark:text-green-400"}):(0,a.jsx)("button",{className:"invisible group-hover:visible focus:visible text-gray-500 hover:text-[#322221] ",onClick:G,children:(0,a.jsx)(R.Z,{size:18})})]})]})})]})})})});q.displayName="ChatMessage";let Q=(0,n.memo)(q,(e,t)=>e.message.content===t.message.content);var ee=l(91500),et=l(87083);let el=e=>{let{conversation:t,prompts:l,onChangePrompt:s}=e,{t:r}=(0,i.$G)("chat"),[o,d]=(0,n.useState)(""),[c,u]=(0,n.useState)(0),[m,x]=(0,n.useState)(!1),[p,h]=(0,n.useState)(""),[g,f]=(0,n.useState)([]),[v,b]=(0,n.useState)(!1),[w,j]=(0,n.useState)(null),[y,N]=(0,n.useState)(!1),k=(0,n.useRef)(null),C=(0,n.useRef)(null);l.filter(e=>e.name.toLowerCase().includes(p.toLowerCase()));let S=e=>{let l=e.target.value,s=t.model.maxLength;if(l.length>s){alert(r("Prompt limit is {{maxLength}} characters. You have entered {{valueLength}} characters.",{maxLength:s,valueLength:l.length}));return}d(l)},L=()=>{if(!o&&1===t.promptState){N(!0);return}I(o),s(o),w&&w.hide()},I=(0,n.useCallback)(e=>{let t=e.match(/\/\w*$/);t?(x(!0),h(t[0].slice(1))):(x(!1),h(""))},[]),E=e=>{let t=null==o?void 0:o.replace(/{{(.*?)}}/g,(t,l)=>{let s=g.indexOf(l);return e[s]});d(t),s(t),k&&k.current&&k.current.focus()};return(0,n.useEffect)(()=>{if(k&&k.current){var e;k.current.style.height="inherit",k.current.style.height="".concat(null===(e=k.current)||void 0===e?void 0:e.scrollHeight,"px")}},[o]),(0,n.useEffect)(()=>{d(t.prompt||"")},[t.prompt]),(0,n.useEffect)(()=>{let e=e=>{C.current&&!C.current.contains(e.target)&&x(!1)};return window.addEventListener("click",e),()=>{window.removeEventListener("click",e)}},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(et.ZP,{content:(0,a.jsxs)("div",{className:"flex flex-col w-[285px] p-4 bg-white border border-black rounded-lg ",children:[(0,a.jsx)("p",{className:"text-black text-[13px] font-bold mb-4",children:r("System Prompt")}),(0,a.jsx)("textarea",{ref:k,className:"w-full resize-none min-h-[150px] max-h-[150px] outline-none rounded-lg border text-xs border-[rgba(0,0,0,.0.15)] bg-transparent p-[10px] text-black ",placeholder:r('Enter a prompt or type "/" to select a prompt...')||"",value:o||"",rows:3,onChange:S}),y&&(0,a.jsx)("div",{className:"text-xs text-[#D43327] mt-1",children:"The prompt of this model cannot be empty!"}),(0,a.jsx)("div",{className:"flex items-center justify-end mt-4 gap-3",children:(0,a.jsx)("div",{className:"inline-flex px-3 py-[6px] capitalize rounded border border-[#D43327] cursor-pointer fm-SpaceMono text-xs text-white bg-[#D43327] leading-5",onClick:()=>L(),children:"save"})})]}),placement:"bottom-end",trigger:"click",interactive:!0,arrow:!1,onCreate:e=>j(e),className:"gaianet-tippy",children:(0,a.jsxs)("div",{className:"inline-flex items-center justify-center gap-3 rounded-lg px-3 h-[44px] text-[13px] bg-white text-black border border-[rgba(0, 0, 0, 0.08)] cursor-pointer hover:border-black transition-all",children:[(0,a.jsx)("p",{children:r("System Prompt")}),(0,a.jsx)(ee.Z,{size:"18",color:"#C0C0C0"})]})}),v&&(0,a.jsx)(A,{prompt:l[c],variables:g,onSubmit:E,onClose:()=>b(!1)})]})};var es=l(79153),er=l(11163);let ea=[{host:"dapp.gaianet-test.link",apiUrl:"https://api.gaianet-test.link/"},{host:"gaianet-test.link",apiUrl:"https://api.gaianet-test.link/"},{host:"www.gaianet-test.link",apiUrl:"https://api.gaianet-test.link/"},{host:"www.gaianet.ai",apiUrl:"https://api.gaianet.ai/"},{host:"gaianet.ai",apiUrl:"https://api.gaianet.ai/"},{host:"localhost:3000",apiUrl:"https://api.gaianet-test.link/"}],en=()=>{var e;let[t,l]=(0,n.useState)(null),[s,r]=(0,n.useState)([]),[i,o]=(0,n.useState)(""),{query:d}=(0,er.useRouter)(),{state:{api:c,selectedConversation:u,defaultModelId:m},dispatch:x}=(0,n.useContext)(I),p=(0,n.useCallback)(e=>{x({field:"api",value:e}),localStorage.setItem("api",e),t&&t.hide()},[x,t]),h=async()=>{var e,t,l,s;let a=window.location.host,n=null===(e=ea.find(e=>(null==e?void 0:e.host)===a))||void 0===e?void 0:e.apiUrl;if(!n)return;let i=await fetch("".concat(n,"api/v1/network/nodes/"),{headers:{"Content-Type":"application/json"}}),o=await i.json();(null==o?void 0:null===(t=o.data)||void 0===t?void 0:null===(l=t.objects)||void 0===l?void 0:l.length)>0&&r(null==o?void 0:null===(s=o.data)||void 0===s?void 0:s.objects)},g=(0,n.useMemo)(()=>{let e=window.location.host;if(ea.find(t=>(null==t?void 0:t.host)===e))return!0},[]);(0,n.useEffect)(()=>{g&&h()},[g]),(0,n.useEffect)(()=>{if(g){if(null==d?void 0:d.subdomain)p("https://".concat(null==d?void 0:d.subdomain));else if(""===c||".."===c){let e=window.location.host;"gaianet.ai"===e||"www.gaianet.ai"===e?p("https://llama3.gaianet.network"):p("https://knowledge.gaianet.xyz")}}},[c,g,p,null==d?void 0:d.subdomain]);let f=e=>{o(e.target.value||"")},v=(0,n.useMemo)(()=>i?s.filter(e=>{var t,l;return(null==e?void 0:null===(t=e.chat_model)||void 0===t?void 0:t.includes(i))||(null==e?void 0:null===(l=e.subdomain)||void 0===l?void 0:l.includes(i))}):s,[s,i]),b=(0,n.useMemo)(()=>(0,a.jsxs)("div",{className:"flex flex-col w-[405px] max-h-[314px] bg-white border border-black rounded-lg overflow-hidden px-3 pt-[14px] pb-4",children:[(0,a.jsx)("p",{className:"text-black fm-SpaceGrotesk text-[14px] font-bold mb-4",children:"Select a Node"}),!g&&(0,a.jsx)("a",{className:"text-gray-800 text-xs cursor-pointer",target:"_blank",href:"https://www.gaianet.ai/",children:"Select More LLM..."}),g&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"w-full relative mb-2",children:[(0,a.jsx)(es.Z,{size:"20",color:"#999999",className:"absolute top-[10px] left-[9px]"}),(0,a.jsx)("input",{type:"text",placeholder:"Search node",className:"w-full h-[40px] pr-2 pl-[35px] text-[12px] text-[#322221] fm-SpaceMono rounded-[8px] outline-none transition-all bg-[#F7F7F7] '",onChange:f})]}),(0,a.jsx)("div",{className:"flex flex-col w-full flex-1  overflow-y-scroll overflow-x-hidden",children:null==v?void 0:v.map(e=>(0,a.jsxs)("div",{className:"cursor-pointer w-full px-1 py-[10px] break-words border-b border-[rgba(0,0,0,.08)] bg-white hover:bg-[#f7f7f7] transition-all",onClick:()=>p("https://".concat(null==e?void 0:e.subdomain)),children:[(0,a.jsx)("p",{className:"text-[13px] text-[#000000] leading-[16px] font-bold",children:(null==e?void 0:e.subdomain)||"-"}),(0,a.jsx)("p",{className:"text-[10px] text-[#888888] leading-[13px] mt-[3px]",children:(null==e?void 0:e.model_name)||"-"})]},null==e?void 0:e.subdomain))})]})]}),[g,p,v]),w=(0,n.useMemo)(()=>{if(c&&c.startsWith("https://"))return c.split("//")[1]},[c]);return(0,a.jsx)(et.ZP,{content:b,placement:"bottom-end",trigger:"click",interactive:!0,arrow:!1,onCreate:e=>l(e),className:"gaianet-tippy",children:(0,a.jsxs)("div",{className:"inline-flex items-center justify-between rounded-lg gap-3 px-3 w-[405px] h-[44px] text-[13px] bg-white text-black border border-[rgba(0, 0, 0, 0.08)] cursor-pointer hover:border-black transition-all",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("p",{className:"text-[13px] leading-[16px] ",children:w||"-"}),(0,a.jsx)("p",{className:"text-[10px] leading-[13px] uppercase mt-[2px] text-[#888888]",children:(null==u?void 0:null===(e=u.model)||void 0===e?void 0:e.id)||m})]}),(0,a.jsx)(ee.Z,{size:"18",color:"#C0C0C0"})]})})};var ei=l(93967),eo=l.n(ei);let ed=(0,n.memo)(e=>{var t,l,s;let r,o;let d,{stopConversationRef:c}=e,{state:{selectedConversation:u,conversations:m,models:x,isStream:p,lightMode:g,api:f,apiKey:j,pluginKeys:y,modelError:N,loading:k,prompts:C,defaultModelId:E},handleUpdateConversation:_,dispatch:P}=(0,n.useContext)(I),{t:A}=(0,i.$G)("chat"),[D,O]=(0,n.useState)(),[F,Z]=(0,n.useState)(0),[R,G]=(0,n.useState)(!0),[M,K]=(0,n.useState)(!1),[U,J]=(0,n.useState)(!1),H=(0,n.useRef)(null),B=(0,n.useRef)(null),$=(0,n.useRef)(null),W=(0,n.useRef)([]),Y="",V=!0,X=(0,n.useRef)(!1),q=!0;async function ee(e){return new Promise(t=>setTimeout(t,e))}async function et(){if(q&&u&&W.current.length>0){q=!1;for(let e=0;e<W.current.length;e++)if(Y+=W.current.shift(),Y=Y.replace(/<\|.*?\|>/g,""),V){V=!1,P({field:"loading",value:!1});let e=[...d.messages,{role:"assistant",content:Y||""}];P({field:"selectedConversation",value:d={...d,messages:e}})}else{let e=d.messages.map((e,t)=>t===d.messages.length-1?{...e,content:Y}:e);b(d={...d,messages:e}),P({field:"selectedConversation",value:d});let t=m.map(e=>e.id===u.id?d:e);0===t.length&&t.push(d),P({field:"conversations",value:t}),w(t),X.current||await ee(W.current.length>10?300:100)}q=!0}}let es=async()=>{for(;0!==W.current.length;)await et()},er=(0,n.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(arguments.length>2&&void 0!==arguments[2]&&arguments[2],u){let s;if(t){let l=[...u.messages];for(let e=0;e<t;e++)l.pop();d={...u,messages:[...l,e]}}else if(d={...u,messages:[...u.messages,e]},0===u.messages.length){var l;d={...d,name:"string"==typeof e.content?e.content:(null===(l=e.content.find(e=>"text"===e.type))||void 0===l?void 0:l.text)||""}}s=d.messages.map(e=>"string"!=typeof e.content?{...e,content:e.content.map(e=>"image_url"===e.type&&e.image_url&&e.image_url.url.startsWith("data:image/")?{...e,image_url:{url:e.image_url.url.split(",")[1]}}:e)}:e),P({field:"selectedConversation",value:d}),P({field:"loading",value:!0}),P({field:"messageIsStreaming",value:!0});let r={model:d.model,messages:s,key:j,prompt:d.prompt,temperature:d.temperature},a=new AbortController;try{let{model:e,messages:t,key:l,prompt:s,temperature:n}=r,i=n;null==i&&(i=h);let o=[];for(let e=t.length-1;e>=0;e--){let l=t[e];o=[l,...o]}if(p){X.current=!1;let t=await S(e,s,i,f,l,o);if(t){let e="",l=new TextDecoder,s=t.getReader();for(;!X.current;){let{value:t,done:r}=await s.read();r&&(X.current=!0);let a=l.decode(t);if(a){let t=a.split("\n\n");t.forEach(t=>{let l=!1;if((t=t.trim()).startsWith("data: ")&&(t=t.substring(6).trim()),"[DONE]"===t?X.current=!0:t.startsWith("{")?t.endsWith("}")||(e=t,l=!0):e?(t=e+t,e=""):l=!0,!l&&!X.current)try{if(t){let e=JSON.parse(t);e&&e.choices&&e.choices.forEach(e=>{e&&e.delta&&e.delta.content&&W.current.push(e.delta.content)}),e&&e.usage&&(console.log("prompt:",e.usage.prompt_tokens),console.log("completion:",e.usage.completion_tokens),console.log("total:",e.usage.total_tokens))}}catch(e){console.log("error JSON",t)}})}q&&es()}P({field:"messageIsStreaming",value:!1}),a.abort()}else P({field:"loading",value:!1}),P({field:"messageIsStreaming",value:!1})}else{let t=await L(e,s,i,f,l,o);if(t){let e=t.choices[0].message,l=[...d.messages,{role:"assistant",content:e.content}];d={...d,messages:l},P({field:"selectedConversation",value:v}),b(d);let s=m.map(e=>e.id===u.id?d:e);0===s.length&&s.push(d),P({field:"conversations",value:s}),w(s),P({field:"loading",value:!1}),P({field:"messageIsStreaming",value:!1}),P({field:"selectedConversation",value:d})}}}catch(e){console.error(e)}}},[f,j,m,y,p,u,c]);(0,n.useCallback)(()=>{if(R){var e,t;null===(e=H.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}),null===(t=$.current)||void 0===t||t.focus()}},[R]);let ea=()=>{if(B.current){let{scrollTop:e,scrollHeight:t,clientHeight:l}=B.current;e+l<t-30?(G(!1),J(!0)):(G(!0),J(!1))}},ei=()=>{var e;null===(e=B.current)||void 0===e||e.scrollTo({top:B.current.scrollHeight,behavior:"smooth"})},ed=()=>{if(R){var e;null===(e=H.current)||void 0===e||e.scrollIntoView(!0)}},ec=function(){for(var e=arguments.length,t=Array(e),l=0;l<e;l++)t[l]=arguments[l];o?(clearTimeout(r),r=setTimeout(()=>{Date.now()-o>=250&&(ed(...t),o=Date.now())},250-(Date.now()-o))):(ed(...t),o=Date.now())};return(0,n.useEffect)(()=>{ec(),u&&(Z(null==u?void 0:u.messages.reduce((e,t)=>(Array.isArray(t.content)&&(e+=t.content.reduce((e,t)=>("image_url"===t.type&&t.image_url&&e++,e),0)),e),0)),O(u.messages[u.messages.length-2]))},[u,ec]),(0,n.useEffect)(()=>{let e=new IntersectionObserver(e=>{let[t]=e;if(G(t.isIntersecting),t.isIntersecting){var l;null===(l=$.current)||void 0===l||l.focus()}},{root:null,threshold:.5}),t=H.current;return t&&e.observe(t),()=>{t&&e.unobserve(t)}},[H]),(0,a.jsx)("div",{className:"relative flex-1 overflow-hidden bg-white",children:j||f?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:eo()("h-full overflow-x-hidden",{charBg:(null==u?void 0:null===(t=u.messages)||void 0===t?void 0:t.length)===0,charMessageBg:(null==u?void 0:null===(l=u.messages)||void 0===l?void 0:l.length)!==0}),ref:B,onScroll:ea,children:[(0,a.jsxs)("div",{className:"sticky z-10 top-0 flex w-full items-center justify-end gap-3 h-[84px] bg-white border-b border-[rgba(0,0,0,0.15)] pr-5",children:[(0,a.jsx)(en,{}),(null==u?void 0:u.promptState)!==2&&u&&(0,a.jsx)(el,{conversation:u,prompts:C,onChangePrompt:e=>_(u,{key:"prompt",value:e})})]}),(null==u?void 0:null===(s=u.messages)||void 0===s?void 0:s.length)!==0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"mt-4 block"}),(null==u?void 0:u.messages)&&u.messages.map((e,t)=>(0,a.jsx)(Q,{message:e,messageIndex:t,maxImg:1-F,onRegenerate:()=>{D&&er(D,u.messages.length-t+1,null)},onEdit:e=>{O(e),er(e,(null==u?void 0:u.messages.length)-t)}},t)),k&&(0,a.jsx)(z,{}),(0,a.jsx)("div",{className:"h-[162px] bg-white",ref:H})]})]}),((null==u?void 0:u.promptState)!==1||(null==u?void 0:u.prompt)!=="")&&(0,a.jsx)(T,{maxImg:1-F,stopConversationRef:c,textareaRef:$,onSend:(e,t)=>{O(e),er(e,0,t)},onScrollDownClick:ei,onRegenerate:()=>{D&&er(D,2,null)},showScrollDownButton:U})]}):(0,a.jsxs)("div",{className:"mx-auto flex h-full w-[300px] flex-col justify-center space-y-6 sm:w-[600px]",children:[(0,a.jsx)("div",{className:"text-center text-4xl font-bold text-[#322221]",children:"Welcome to GaiaNet-AI Chat"}),(0,a.jsxs)("div",{className:"text-center text-[#322221]/70",children:[(0,a.jsx)("div",{className:"mb-2",children:"GaiaNet-AI Chat allows you to plug in your API key to use this UI with their API."}),(0,a.jsxs)("div",{className:"mb-2",children:["It is ",(0,a.jsx)("span",{className:"italic",children:"only"})," used to communicate with their API."]})]})]})})});ed.displayName="Chat";let ec=()=>{let e=localStorage.getItem("conversationHistory"),t=localStorage.getItem("folders"),l=localStorage.getItem("prompts");e&&(e=JSON.parse(e)),t&&(t=JSON.parse(t)),l&&(l=JSON.parse(l));let s={version:4,history:e||[],folders:t||[],prompts:l||[]},r=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),a=URL.createObjectURL(r),n=document.createElement("a");n.download="chatbot_ui_history_".concat(function(){let e=new Date,t=e.getMonth()+1,l=e.getDate();return"".concat(t,"-").concat(l)}(),".json"),n.href=a,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)},eu=e=>{let{history:t,folders:l,prompts:s}=function(e){if(Array.isArray(e))return{version:4,history:f(e),folders:[],prompts:[]};if(!("version"in e)&&"folders"in e&&"history"in e)return{version:4,history:f(e.history||[]),folders:(e.folders||[]).map(e=>({id:e.id.toString(),name:e.name,type:"chat"})),prompts:[]};if(3===e.version)return{...e,version:4,prompts:[]};if(4===e.version)return e;throw Error("Unsupported data format")}(e),r=localStorage.getItem("conversationHistory"),a=r?JSON.parse(r):[],n=[...a,...t].filter((e,t,l)=>t===l.findIndex(t=>t.id===e.id));localStorage.setItem("conversationHistory",JSON.stringify(n)),n.length>0?localStorage.setItem("selectedConversation",JSON.stringify(n[n.length-1])):localStorage.removeItem("selectedConversation");let i=localStorage.getItem("folders"),o=i?JSON.parse(i):[],d=[...o,...l].filter((e,t,l)=>t===l.findIndex(t=>t.id===e.id));localStorage.setItem("folders",JSON.stringify(d));let c=localStorage.getItem("prompts"),u=c?JSON.parse(c):[],m=[...u,...s].filter((e,t,l)=>t===l.findIndex(t=>t.id===e.id));return localStorage.setItem("prompts",JSON.stringify(m)),{version:4,history:n,folders:d,prompts:m}};var em=l(30471),ex=l(97283);let ep=e=>{let{handleClick:t,children:l}=e;return(0,a.jsx)("button",{className:"min-w-[20px] p-1 text-[#D2D2D2] hover:text-black",onClick:t,children:l})},eh=e=>{let{currentFolder:t,searchTerm:l,handleDrop:s,folderComponent:r}=e,{handleDeleteFolder:i,handleUpdateFolder:o}=(0,n.useContext)(I),[d,c]=(0,n.useState)(!1),[u,m]=(0,n.useState)(!1),[x,p]=(0,n.useState)(""),[h,g]=(0,n.useState)(!1),f=e=>{"Enter"===e.key&&(e.preventDefault(),v())},v=()=>{o(t.id,x),p(""),m(!1)},b=e=>{e.dataTransfer&&(g(!0),s(e,t),e.target.style.background="none")},w=e=>{e.preventDefault()},j=e=>{e.target.style.background="#f7f7f7"},y=e=>{e.target.style.background="none"};return(0,n.useEffect)(()=>{u?c(!1):d&&m(!1)},[u,d]),(0,n.useEffect)(()=>{l?g(!0):g(!1)},[l]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"relative flex items-center ",children:[u?(0,a.jsxs)("div",{className:"flex w-full items-center gap-3 py-3",children:[h?(0,a.jsx)("img",{style:{width:"12px",height:"12px"},src:"./icons/icon-care-down.svg",alt:""}):(0,a.jsx)("img",{style:{width:"12px",height:"12px"},src:"./icons/icon-care-right.svg",alt:""}),(0,a.jsx)("input",{className:"mr-12 flex-1 overflow-hidden overflow-ellipsis border-neutral-400 uppercase bg-transparent text-left text-[13px] leading-5 font-bold text-black outline-none focus:border-neutral-100 fm-SpaceGrotesk",type:"text",value:x,onChange:e=>p(e.target.value),onKeyDown:f,autoFocus:!0})]}):(0,a.jsxs)("div",{className:"w-full h-full relative group flex items-center",children:[(0,a.jsxs)("button",{className:"flex w-full cursor-pointer items-center gap-3 py-3 text-sm transition-colors duration-200 ",onClick:()=>g(!h),onDrop:e=>b(e),onDragOver:w,onDragEnter:j,onDragLeave:y,children:[h?(0,a.jsx)("img",{style:{width:"12px",height:"12px"},src:"./icons/icon-care-down.svg",alt:""}):(0,a.jsx)("img",{style:{width:"12px",height:"12px"},src:"./icons/icon-care-right.svg",alt:""}),(0,a.jsx)("div",{className:"relative max-h-5 flex-1 overflow-hidden text-ellipsis uppercase whitespace-nowrap text-[#000000] font-bold break-all text-left text-[13px] leading-5 fm-SpaceGrotesk bg-white",children:t.name})]}),!d&&!u&&(0,a.jsxs)("div",{className:"absolute right-1 z-10 invisible text-gray-300 group-hover:visible transition-all",children:[(0,a.jsx)(ep,{handleClick:e=>{e.stopPropagation(),m(!0),p(t.name)},children:(0,a.jsx)(em.Z,{size:18})}),(0,a.jsx)(ep,{handleClick:e=>{e.stopPropagation(),c(!0)},children:(0,a.jsx)(O.Z,{size:18})})]})]}),(d||u)&&(0,a.jsxs)("div",{className:"absolute right-1 z-10 flex text-gray-300",children:[(0,a.jsx)(ep,{handleClick:e=>{e.stopPropagation(),d?i(t.id):u&&v(),c(!1),m(!1)},children:(0,a.jsx)(Z.Z,{size:18})}),(0,a.jsx)(ep,{handleClick:e=>{e.stopPropagation(),c(!1),m(!1)},children:(0,a.jsx)(ex.Z,{size:18})})]})]}),h?r:null]})},eg=(0,n.createContext)(void 0),ef=e=>{let{conversation:t}=e,{state:{selectedConversation:l,messageIsStreaming:s},handleSelectConversation:r,handleUpdateConversation:i}=(0,n.useContext)(I),{handleDeleteConversation:o}=(0,n.useContext)(eg),[d,c]=(0,n.useState)(!1),[u,m]=(0,n.useState)(!1),[x,p]=(0,n.useState)(""),h=e=>{"Enter"===e.key&&(e.preventDefault(),l&&f(l))},g=(e,t)=>{e.dataTransfer&&e.dataTransfer.setData("conversation",JSON.stringify(t))},f=e=>{x.trim().length>0&&(i(e,{key:"name",value:x}),p(""),m(!1))},v=e=>{e.stopPropagation(),d?o(t):u&&f(t),c(!1),m(!1)},b=e=>{e.stopPropagation(),c(!1),m(!1)},w=e=>{e.stopPropagation(),m(!0),l&&p(l.name)},j=e=>{e.stopPropagation(),c(!0)};return(0,n.useEffect)(()=>{u?c(!1):d&&m(!1)},[u,d]),(0,a.jsxs)("div",{className:"relative flex items-center",children:[u&&(null==l?void 0:l.id)===t.id?(0,a.jsxs)("div",{className:"flex w-full items-center gap-2 rounded bg-[#ffffff] px-[10px] py-[11px]",children:[(0,a.jsx)("img",{style:{width:"16px",height:"16px"},src:"./icons/icon-message.svg",alt:""}),(0,a.jsx)("input",{className:"mr-12 flex-1 overflow-hidden overflow-ellipsis border-neutral-400 bg-transparent text-left text-[12px] leading-3 text-[#322221] outline-none fm-SpaceMono focus:border-neutral-100",type:"text",value:x,onChange:e=>p(e.target.value),onKeyDown:h,autoFocus:!0})]}):(0,a.jsxs)("button",{className:"flex w-full cursor-pointer items-center gap-2 rounded pl-[10px] px-[10px] py-3 text-sm transition-colors duration-200 hover:bg-[#FAFAFA] ".concat(s?"disabled:cursor-not-allowed":""," ").concat((null==l?void 0:l.id)===t.id?"bg-[#FAFAFA]":""),onClick:()=>r(t),disabled:s,draggable:"true",onDragStart:e=>g(e,t),children:[(0,a.jsx)("img",{style:{width:"16px",height:"16px"},src:"./icons/icon-message.svg",alt:""}),(0,a.jsx)("div",{className:"relative max-h-5 flex-1 overflow-hidden text-ellipsis whitespace-nowrap break-all text-left text-[12px] leading-3 text-[#322221] fm-SpaceMono ".concat((null==l?void 0:l.id)===t.id?"pr-12":"pr-1"),children:t.name})]}),(d||u)&&(null==l?void 0:l.id)===t.id&&(0,a.jsxs)("div",{className:"absolute right-1 z-10 flex text-gray-300",children:[(0,a.jsx)(ep,{handleClick:v,children:(0,a.jsx)(Z.Z,{size:18})}),(0,a.jsx)(ep,{handleClick:b,children:(0,a.jsx)(ex.Z,{size:18})})]}),(null==l?void 0:l.id)===t.id&&!d&&!u&&(0,a.jsxs)("div",{className:"absolute right-1 z-10 flex text-gray-300",children:[(0,a.jsx)(ep,{handleClick:w,children:(0,a.jsx)(em.Z,{size:18})}),(0,a.jsx)(ep,{handleClick:j,children:(0,a.jsx)(O.Z,{size:18})})]})]})},ev=e=>{let{searchTerm:t}=e,{state:{folders:l,conversations:s},handleUpdateConversation:r}=(0,n.useContext)(I),i=(e,t)=>{if(e.dataTransfer){let l=JSON.parse(e.dataTransfer.getData("conversation"));r(l,{key:"folderId",value:t.id})}},o=e=>s&&s.filter(e=>e.folderId).map((t,l)=>{if(t.folderId===e.id)return(0,a.jsx)("div",{className:"ml-5 gap-2 border-l pl-2",children:(0,a.jsx)(ef,{conversation:t})},l)});return(0,a.jsx)("div",{className:"flex w-full flex-col pt-2",children:l.filter(e=>"chat"===e.type).sort((e,t)=>e.name.localeCompare(t.name)).map((e,l)=>(0,a.jsx)(eh,{searchTerm:t,currentFolder:e,handleDrop:i,folderComponent:o(e)},l))})};var eb=l(17010),ew=l(33111);let ej=e=>{let{open:t,onClose:l}=e,s=(0,n.useRef)(null),[r,i]=(0,n.useState)(!1),{state:{api:o}}=(0,n.useContext)(I);(0,n.useEffect)(()=>{let e=e=>{s.current&&!s.current.contains(e.target)&&window.addEventListener("mouseup",t)},t=e=>{window.removeEventListener("mouseup",t),l()};return window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}},[l]);let d=()=>{navigator.clipboard&&navigator.clipboard.writeText("curl -X POST ".concat(o,"v1/chat/completions  -H 'accept: application/json'  -H 'Content-Type: application/json' -D '").concat(c,"'")).then(()=>{i(!0),setTimeout(()=>{i(!1)},2e3)})};if(!t)return(0,a.jsx)(a.Fragment,{});let c='{"messages":[{"role":"system", "content": "You are a helpful assistant."}, {"role":"user", "content": "Where is Paris?"}]}';return(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:(0,a.jsx)("div",{className:"fixed inset-0 z-10 overflow-hidden",children:(0,a.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[(0,a.jsx)("div",{className:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true"}),(0,a.jsxs)("div",{ref:s,className:"relative inline-block max-h-[400px] transform overflow-y-auto rounded-lg bg-white p-6 text-left align-bottom shadow-xl transition-all sm:my-8 sm:max-h-[600px] sm:w-full sm:max-w-lg sm:p-6 sm:align-middle",role:"dialog",children:[(0,a.jsx)("div",{className:"text-lg pb-2 font-bold text-black fm-SpaceGrotesk",children:"Send an API request to the node"}),(0,a.jsx)(ex.Z,{size:20,color:"#262626",className:"absolute top-4 right-4 cursor-pointer",onClick:()=>{l()}}),(0,a.jsx)("p",{className:"text-[#696868] text-xs",children:"The node supports the OpenAI JSON format. If you have an OpenAI-based agent or application, you simply need to replace the\xa0api.openai.com\xa0URL in your app with the node's public URL."}),(0,a.jsxs)("div",{className:"w-full bg-[#1E1E1E] rounded-lg overflow-hidden mt-8",children:[(0,a.jsx)("div",{className:"flex items-center justify-end bg-[#302F2F] w-full h-[38px]",children:r?(0,a.jsx)(Z.Z,{size:18,className:"text-green-500 dark:text-green-400 mr-4"}):(0,a.jsxs)("p",{className:"flex items-center gap-1 mr-4 cursor-pointer",onClick:d,children:[(0,a.jsx)("span",{className:"capitalize text-sm",children:"copy"}),(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:[(0,a.jsx)("path",{d:"M10.8889 1.5H5.80952L2 5.19231V12.1667H10.8889V1.5Z",stroke:"white"}),(0,a.jsx)("path",{d:"M11.3327 4.16675H13.5549V14.8334H4.66602V12.1667",stroke:"white"})]})]})}),(0,a.jsx)("div",{className:"w-full p-5 ",children:(0,a.jsxs)("code",{className:"break-words",children:["curl -X POST ",o," ",(0,a.jsx)("br",{}),"v1/chat/completions \\ ",(0,a.jsx)("br",{}),"\xa0\xa0-H 'accept: application/json' \\",(0,a.jsx)("br",{}),"\xa0\xa0-H 'Content-Type: application/json' \\",(0,a.jsx)("br",{}),"\xa0\xa0-D '",c,"'"]})})]})]})]})})})};var ey=l(36465),eN=l.n(ey);let ek=()=>(0,a.jsx)("span",{className:"jsx-1a6b7a8c2aa90159 gaianetLoader",children:(0,a.jsx)(eN(),{id:"1a6b7a8c2aa90159",children:".gaianetLoader.jsx-1a6b7a8c2aa90159{width:36px;height:36px;border:3px solid#d43327;border-bottom-color:transparent;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;display:inline-block;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-animation:rotation 1s linear infinite;-moz-animation:rotation 1s linear infinite;-o-animation:rotation 1s linear infinite;animation:rotation 1s linear infinite}@-webkit-keyframes rotation{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes rotation{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes rotation{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotation{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})}),eC=e=>{let{open:t,onClose:l}=e,s=(0,n.useRef)(null),[r,i]=(0,n.useState)(),[o,d]=(0,n.useState)(!0),{state:{api:c}}=(0,n.useContext)(I);return((0,n.useEffect)(()=>{t&&(d(!0),fetch("".concat(c,"/config_pub.json")).then(e=>e.json()).then(e=>{i(e),d(!1)}).catch(e=>{d(!1),console.error("Error fetching JSON:",e)}))},[c,t]),(0,n.useEffect)(()=>{let e=e=>{s.current&&!s.current.contains(e.target)&&window.addEventListener("mouseup",t)},t=e=>{window.removeEventListener("mouseup",t),l()};return window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}},[l]),t)?(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:(0,a.jsx)("div",{className:"fixed inset-0 z-10 overflow-hidden",children:(0,a.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[(0,a.jsx)("div",{className:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true"}),(0,a.jsxs)("div",{ref:s,className:"relative inline-block max-h-[400px] transform overflow-y-auto rounded-lg bg-white p-6 text-left align-bottom shadow-xl transition-all sm:my-8 sm:max-h-[600px] sm:w-full sm:max-w-[600px] sm:p-6 sm:align-middle",role:"dialog",children:[(0,a.jsx)(ex.Z,{size:20,color:"#262626",className:"absolute top-4 right-4 cursor-pointer",onClick:()=>{l()}}),o?(0,a.jsx)("div",{className:"w-full min-h-[280px] flex items-center justify-center",children:(0,a.jsx)(ek,{})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex item-center h-[38px] border-b border-[rgba(0,0,0,.08)]",children:[(0,a.jsx)("p",{className:"font-bold text-black fm-SpaceGrotesk text-base lg:text-lg w-[200px]",children:"Attribute"}),(0,a.jsx)("p",{className:"font-bold text-black fm-SpaceGrotesk text-base lg:text-lg flex-1",children:"Value"})]}),(0,a.jsxs)("div",{className:"flex item-center flex-col lg:flex-row min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#F7F7F7] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0 ",children:"Node ID"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==r?void 0:r.address)||"-"})]}),(0,a.jsxs)("div",{className:"flex item-center  flex-col lg:flex-row min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#ffffff] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0",children:"GaiaNet Domain"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==r?void 0:r.domain)||"-"})]}),(0,a.jsxs)("div",{className:"flex item-center flex-col lg:flex-row min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#F7F7F7] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0",children:"Subdomain"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==r?void 0:r.address)&&(null==r?void 0:r.domain)?"https://".concat(null==r?void 0:r.address,".").concat(null==r?void 0:r.domain):"-"})]}),(0,a.jsxs)("div",{className:"flex item-center flex-col lg:flex-row min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#ffffff] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0",children:"Description"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==r?void 0:r.description)||"-"})]}),(0,a.jsxs)("div",{className:"flex item-center flex-col lg:flex-row  min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#F7F7F7] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0 ",children:"Fine-tuned LLM"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==r?void 0:r.chat)?null==r?void 0:r.chat.split("/").pop():"-"})]}),(0,a.jsxs)("div",{className:"flex item-center flex-col lg:flex-row min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#ffffff] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0",children:"System Prompt"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==r?void 0:r.system_prompt)||"-"})]}),(0,a.jsxs)("div",{className:"flex item-center flex-col lg:flex-row min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#F7F7F7] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0",children:"Embedding Model"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==r?void 0:r.embedding)?null==r?void 0:r.embedding.split("/").pop():"-"})]}),(0,a.jsxs)("div",{className:"flex item-center flex-col lg:flex-row min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#ffffff] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0",children:"Knowledge Base"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==r?void 0:r.snapshot)?null==r?void 0:r.snapshot.split("/").pop():"-"})]}),(0,a.jsxs)("div",{className:"flex item-center flex-col lg:flex-row min-h-[38px] border-b border-[rgba(0,0,0,.08)] bg-[#F7F7F7] py-3",children:[(0,a.jsx)("p",{className:"text-[#555555] text-xs w-[200px] pl-3 flex-shrink-0",children:"RAG Prompt"}),(0,a.jsx)("p",{className:"text-[#555555] text-xs flex-1 pl-3 lg:pl-0 mt-1 lg:mt-0 break-all",children:(null==r?void 0:r.rag_prompt)||"-"})]})]})]})]})})}):(0,a.jsx)(a.Fragment,{})},eS=e=>{let{open:t,onClose:l}=e,{t:s}=(0,i.$G)("settings"),r=k(),{state:o,dispatch:d}=c({initialState:r}),{dispatch:u}=(0,n.useContext)(I),m=(0,n.useRef)(null);(0,n.useEffect)(()=>{let e=e=>{m.current&&!m.current.contains(e.target)&&window.addEventListener("mouseup",t)},t=e=>{window.removeEventListener("mouseup",t),l()};return window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}},[l]);let x=()=>{u({field:"isStream",value:o.isStream}),console.log(o.isStream),C(o)};return t?(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:(0,a.jsx)("div",{className:"fixed inset-0 z-10 overflow-hidden",children:(0,a.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[(0,a.jsx)("div",{className:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true"}),(0,a.jsxs)("div",{ref:m,className:"relative inline-block max-h-[400px] transform overflow-y-auto rounded-lg bg-white p-6 text-left align-bottom shadow-xl transition-all sm:my-8 sm:max-h-[600px] sm:w-full sm:max-w-lg sm:p-6 sm:align-middle",role:"dialog",children:[(0,a.jsx)("div",{className:"text-lg pb-5 font-bold text-black fm-SpaceGrotesk",children:s("Settings")}),(0,a.jsx)(ex.Z,{size:20,color:"#262626",className:"absolute top-4 right-4 cursor-pointer",onClick:()=>{l()}}),(0,a.jsx)("div",{className:"text-sm font-bold mb-2 text-black ",children:s("Output type")}),(0,a.jsxs)("select",{className:"w-full cursor-pointer bg-transparent p-3 outline-none text-black border border-[rgba(0,0,0,.08)] hover:border-[#322221] transition-all rounded-lg",value:o.isStream.toString(),onChange:e=>{console.log(e.target.value),d({field:"isStream",value:"true"===e.target.value})},children:[(0,a.jsx)("option",{value:"false",children:s("Completed output")}),(0,a.jsx)("option",{value:"true",children:s("Streaming output")})]}),(0,a.jsx)("button",{type:"button",className:"w-full px-4 leading-5 text-sm py-2 mt-8 border border-[#D43327] rounded-lg bg-[#D43327] text-white outline-none transition-all hover:text-[#D43327] hover:bg-white hover:border-[#D43327]",onClick:()=>{x(),l()},children:s("Save")})]})]})})}):(0,a.jsx)(a.Fragment,{})};var eL=l(47083);let eI=e=>{let{text:t,icon:l,onClick:s}=e;return(0,a.jsxs)("button",{className:"flex w-full cursor-pointer select-none items-center gap-3 rounded-md py-3 px-4 text-[14px] leading-3 text-[#322221] transition-colors duration-200 hover:bg-gray-500/10 fm-SpaceGrotesk",onClick:s,children:[(0,a.jsx)("div",{children:l}),(0,a.jsx)("span",{className:"capitalize",children:t})]})},eE=e=>{let{api:t,onApiChange:l}=e,{t:s}=(0,i.$G)("sidebar"),[r,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)(t),u=(0,n.useRef)(null),m=e=>{"Enter"===e.key&&(e.preventDefault(),x(d))},x=e=>{l(e.trim()),o(!1)};return(0,n.useEffect)(()=>{if(r){var e;null===(e=u.current)||void 0===e||e.focus()}},[r]),r?(0,a.jsxs)("div",{className:"duration:200 flex w-full cursor-pointer items-center rounded-md py-[11px] px-4 transition-colors hover:bg-gray-500/10",children:[(0,a.jsx)(eL.Z,{size:18,color:"#322221"}),(0,a.jsx)("input",{ref:u,className:"ml-2 h-[20px] flex-1 overflow-hidden overflow-ellipsis border-b border-neutral-400 bg-transparent pr-1 text-[12.5px] leading-3 text-left text-[#322221] outline-none focus:border-neutral-100",value:d,onChange:e=>c(e.target.value),onKeyDown:m,placeholder:s("API Url")||"API Url"}),(0,a.jsxs)("div",{className:"flex w-[40px]",children:[(0,a.jsx)(Z.Z,{className:"ml-auto min-w-[20px] text-neutral-400 hover:text-[#322221]",size:18,onClick:e=>{e.stopPropagation(),x(d)}}),(0,a.jsx)(ex.Z,{className:"ml-auto min-w-[20px] text-neutral-400 hover:text-[#322221]",size:18,onClick:e=>{e.stopPropagation(),o(!1),c(t)}})]})]}):(0,a.jsx)(eI,{text:s("Chat API Url"),icon:(0,a.jsx)(eL.Z,{size:18}),onClick:()=>o(!0)})},e_=e=>{let{onClearConversations:t}=e,[l,s]=(0,n.useState)(!1),{t:r}=(0,i.$G)("sidebar"),o=()=>{t(),s(!1)};return l?(0,a.jsxs)("div",{className:"flex w-full cursor-pointer items-center rounded-lg py-3 px-4 hover:bg-[#fafafa]",children:[(0,a.jsx)(O.Z,{size:18,color:"#322221"}),(0,a.jsx)("div",{className:"ml-3 flex-1 text-left text-[14px] leading-3 text-[#322221] fm-SpaceGrotesk",children:r("Are you sure?")}),(0,a.jsxs)("div",{className:"flex w-[40px]",children:[(0,a.jsx)(Z.Z,{className:"ml-auto mr-1 min-w-[20px] text-neutral-400 hover:text-[#322221]",size:18,onClick:e=>{e.stopPropagation(),o()}}),(0,a.jsx)(ex.Z,{className:"ml-auto min-w-[20px] text-neutral-400 hover:text-[#322221]",size:18,onClick:e=>{e.stopPropagation(),s(!1)}})]})]}):(0,a.jsx)(eI,{text:r("Clear conversations"),icon:(0,a.jsx)(O.Z,{size:18}),onClick:()=>s(!0)})},eP=()=>{let{t:e}=(0,i.$G)("sidebar"),[t,l]=(0,n.useState)(!1),[s,r]=(0,n.useState)(!1),[o,d]=(0,n.useState)(!1),{state:{api:c,apiKey:u,lightMode:m,serverSideApiKeyIsSet:x,serverSidePluginKeysSet:p,conversations:h},dispatch:g}=(0,n.useContext)(I),{handleClearConversations:f,handleImportConversations:v,handleExportData:b,handleApiChange:w,handleApiKeyChange:j}=(0,n.useContext)(eg);return(0,a.jsxs)("div",{className:"flex flex-col items-center border-t border-[rgb(229, 231, 235))] pt-1 text-sm",children:[h.length>0?(0,a.jsx)(e_,{onClearConversations:f}):null,(0,a.jsx)(eI,{text:"API Tutorial",icon:(0,a.jsx)("img",{style:{width:"18px",height:"18px"},src:"./icons/APITutorial.png",alt:""}),onClick:()=>d(!0)}),(0,a.jsx)(eI,{text:"node info",icon:(0,a.jsx)(eb.Z,{size:18}),onClick:()=>l(!0)}),(0,a.jsx)(eE,{api:c,onApiChange:w}),(0,a.jsx)(eI,{text:e("Settings"),icon:(0,a.jsx)(ew.Z,{size:18}),onClick:()=>r(!0)}),(0,a.jsxs)("div",{className:"w-full flex items-center justify-center gap-3 border-t border-[rgb(229, 231, 235))] py-5",children:[(0,a.jsx)("div",{className:"group",onClick:()=>window.open("https://twitter.com/gaianet_ai","_blank"),children:(0,a.jsxs)("div",{className:"flex items-center justify-center w-[36px] h-[36px] rounded-[18px] border border-[#322221] cursor-pointer bg-white group-hover:bg-[#D43327] transition-all ",children:[(0,a.jsx)("img",{style:{width:"18px",height:"18px"},src:"./icons/twitter.svg",alt:"",className:"block group-hover:hidden"}),(0,a.jsx)("img",{style:{width:"18px",height:"18px"},src:"./icons/twitter-white.svg",alt:"",className:"hidden group-hover:block"})]})}),(0,a.jsx)("div",{className:"group",onClick:()=>window.open("https://github.com/GaiaNet-AI","_blank"),children:(0,a.jsxs)("div",{className:"flex items-center justify-center w-[36px] h-[36px] rounded-[18px] border border-[#322221] cursor-pointer bg-white group-hover:bg-[#D43327] transition-all ",children:[(0,a.jsx)("img",{style:{width:"18px",height:"18px"},src:"./icons/github.svg",alt:"",className:"block group-hover:hidden"}),(0,a.jsx)("img",{style:{width:"18px",height:"18px"},src:"./icons/github-white.svg",alt:"",className:"hidden group-hover:block"})]})}),(0,a.jsx)("div",{className:"group",onClick:()=>window.open("https://huggingface.co/gaianet","_blank"),children:(0,a.jsxs)("div",{className:"flex items-center justify-center w-[36px] h-[36px] rounded-[18px] border border-[#322221] cursor-pointer bg-white group-hover:bg-[#D43327] transition-all ",children:[(0,a.jsx)("img",{style:{width:"18px",height:"18px"},src:"./icons/huggingface.svg",alt:"",className:"block group-hover:hidden"}),(0,a.jsx)("img",{style:{width:"18px",height:"18px"},src:"./icons/huggingface-white.svg",alt:"",className:"hidden group-hover:block"})]})})]}),(0,a.jsx)(eS,{open:s,onClose:()=>{r(!1)}}),(0,a.jsx)(ej,{open:o,onClose:()=>{d(!1)}}),(0,a.jsx)(eC,{open:t,onClose:()=>{l(!1)}})]})},eA=e=>{let{conversations:t}=e;return(0,a.jsx)("div",{className:"flex w-full flex-col gap-1",children:t.filter(e=>!e.folderId).slice().reverse().map((e,t)=>(0,a.jsx)(ef,{conversation:e},t))})};var eT=l(1177),ez=l(16745),eD=l(92005),eO=l(67421),eF=l(98963),eZ=l(89014);let eR=e=>{let{onClick:t,side:l}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{className:"fixed top-0 ".concat("right"===l?"right-[290px]":"left-[290px]"," z-50 h-14 w-7 hover:text-gray-400 dark:text-white dark:hover:text-gray-300 sm:").concat("right"===l?"right-[290px]":"left-[290px]"," sm:h-[84px] sm:w-8 sm:text-neutral-700"),onClick:t,children:"right"===l?(0,a.jsx)(eF.Z,{color:"#989898"}):(0,a.jsx)(eZ.Z,{color:"#989898"})}),(0,a.jsx)("div",{onClick:t,className:"absolute top-0 left-0 z-10 h-full w-full bg-black opacity-70 sm:hidden"})]})},eG=e=>{let{onClick:t,side:l}=e;return(0,a.jsx)("button",{className:"fixed top-0 ".concat("right"===l?"right-2":"left-2"," z-50 h-14 w-7 text-white hover:text-gray-400 dark:text-white dark:hover:text-gray-300 sm:").concat("right"===l?"right-2":"left-2"," sm:h-[84px] sm:w-8 sm:text-neutral-700"),onClick:t,children:"right"===l?(0,a.jsx)(eZ.Z,{color:"#989898"}):(0,a.jsx)(eF.Z,{color:"#989898"})})},eM=e=>{let{t}=(0,i.$G)("sidebar"),{placeholder:l,searchTerm:s,onSearch:r,...n}=e,o=e=>{r(e.target.value)},d=()=>{r("")};return(0,a.jsxs)("div",{className:eo()("relative flex items-center",null==n?void 0:n.className),children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",className:"absolute left-2",children:(0,a.jsx)("path",{d:"M12.7508 11.35L14.9008 13.5C15.1008 13.7 15.1008 14 14.9008 14.2L14.2008 14.9C14.0008 15.1 13.7008 15.1 13.5008 14.9L11.4008 12.8C10.3008 13.6 9.00078 14.05 7.55078 14.05C3.95078 14.05 1.05078 11.15 1.05078 7.55005C1.05078 3.95005 3.95078 1.05005 7.55078 1.05005C11.1508 1.05005 14.0508 3.95005 14.0508 7.55005C14.0008 8.95005 13.5508 10.25 12.7508 11.35ZM7.50078 13C10.5508 13 13.0008 10.55 13.0008 7.50005C13.0008 4.45005 10.5508 2.00005 7.50078 2.00005C4.45078 2.00005 2.00078 4.45005 2.00078 7.50005C2.00078 10.55 4.45078 13 7.50078 13Z",fill:"#C9BEC3"})}),(0,a.jsx)("input",{className:"w-full flex-1 rounded border border-[rgba(0, 0, 0, 0.08)] outline-none bg-[#ffffff] pl-7 py-3 pr-10 text-[14px] leading-3 text-[#322221] inputPlaceholderSourceCodePro ",type:"text",placeholder:t(l)||"",value:s,onChange:o}),s&&(0,a.jsx)(ex.Z,{className:"absolute  z-10 right-4 cursor-pointer text-neutral-300 hover:text-neutral-400",size:18,onClick:d})]})},eK=e=>{let{isOpen:t,addItemButtonTitle:l,canCreateChat:s,side:r,items:i,itemComponent:o,folderComponent:d,footerComponent:c,searchTerm:u,handleSearchTerm:m,toggleOpen:x,handleCreateItem:p,handleCreateFolder:h,handleDrop:g}=e,{t:f}=(0,eO.$G)("promptbar"),v=e=>{e.preventDefault()},b=e=>{e.target.style.background="#343541"},w=e=>{e.target.style.background="none"},j=(0,n.useMemo)(()=>{let e=window.location.host;if(ea.find(t=>(null==t?void 0:t.host)===e))return!0},[]),y=()=>{j&&(window.location.href="/")};return t?(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"fixed top-0 ".concat(r,"-0 z-40 flex flex-col h-full w-[280px] border-r border-[rgba(0,0,0,0.08)]  space-y-2 bg-[#ffffff] text-[14px] transition-all sm:relative sm:top-0"),children:[(0,a.jsxs)("div",{className:"w-full flex-1 flex flex-col pt-[29px] overflow-auto",children:[(0,a.jsxs)("div",{className:"px-4 ",children:[(0,a.jsx)("img",{className:"w-40 h-10 mx-auto cursor-pointer",src:"./GaiaNet-black.svg",alt:"",onClick:y}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-8 ",children:[(0,a.jsx)("div",{className:"group",children:(0,a.jsxs)("button",{disabled:!s,className:"flex w-[202px] h-[42px] flex-shrink-0 select-none items-center text-base justify-center gap-1 bg-[#F7F7F7]  group-hover:bg-[#D43327] font-bold rounded text-[#D43327] group-hover:text-[#ffffff] transition-colors duration-200 uppercase fm-SpaceGrotesk "+(s?"cursor-pointer":"cursor-not-allowed"),onClick:()=>{p(),m("")},children:[(0,a.jsx)(eT.Z,{size:16,className:"text-[#D43327] group-hover:text-[#ffffff]"}),l]})}),(0,a.jsx)("div",{className:"group",children:(0,a.jsx)("button",{disabled:!s,className:"flex flex-shrink-0 items-center justify-center rounded w-[42px] h-[42px] transition-colors duration-200 bg-[#F5F5F5] group-hover:bg-[#D43327] "+(s?"cursor-pointer":"cursor-not-allowed"),onClick:h,children:(0,a.jsx)(ez.Z,{size:16,className:"text-[#322221] group-hover:text-[#ffffff]"})})})]}),(0,a.jsx)(eM,{className:"mt-2",placeholder:f("Search...")||"",searchTerm:u,onSearch:m})]}),(0,a.jsxs)("div",{className:"flex-grow overflow-auto",children:[(null==i?void 0:i.length)>0&&(0,a.jsx)("div",{className:"px-4 ",children:(0,a.jsx)("div",{className:"flex border-b border-white/20 pb-2",children:d})}),(null==i?void 0:i.length)>0?(0,a.jsx)("div",{className:"pt-2 border-t border-[rgba(0,0,0,0.15)] px-4",onDrop:g,onDragOver:v,onDragEnter:b,onDragLeave:w,children:o}):(0,a.jsxs)("div",{className:"mt-8 select-none text-center text-[#322221] opacity-50",children:[(0,a.jsx)(eD.Z,{className:"mx-auto mb-3",color:"#322221"}),(0,a.jsx)("span",{className:"text-[14px] ",children:f("No data.")})]})]})]}),c]}),(0,a.jsx)(eR,{onClick:x,side:r})]}):(0,a.jsx)(eG,{onClick:x,side:r})},eU={searchTerm:"",filteredConversations:[]};var eJ=l(57632);let eH=[{id:"llama-2-chat",description:"",content:"You are a helpful, respectful and honest assistant. Always answer as short as possible, while being safe.",controlState:0},{id:"codellama-instruct",description:"",content:"You are a helpful, respectful and honest assistant. Always answer as short as possible, while being safe.",controlState:0},{id:"vicuna-chat",description:"",content:"You are a helpful, respectful and honest assistant. Always answer as short as possible, while being safe.",controlState:0},{id:"chatml",description:"",content:"Answer as concisely as possible.",controlState:1},{id:"mistral-instruct-v0.1",description:"",content:"",controlState:2},{id:"belle-llama-2-chat",description:"",content:"",controlState:2}],eB=()=>{let{t:e}=(0,i.$G)("sidebar"),t=c({initialState:eU}),{state:{conversations:l,showChatbar:s,models:r,folders:o,pluginKeys:d},dispatch:u,handleCreateFolder:m,handleNewConversation:x,handleUpdateConversation:p}=(0,n.useContext)(I),{state:{searchTerm:g,filteredConversations:f},dispatch:v}=t,y=(0,n.useCallback)(e=>{u({field:"api",value:e}),localStorage.setItem("api",e)},[u]),N=(0,n.useCallback)(e=>{u({field:"apiKey",value:e}),localStorage.setItem("apiKey",e)},[u]),k=e=>{if(d.some(t=>t.pluginId===e.pluginId)){let t=d.map(t=>t.pluginId===e.pluginId?e:t);u({field:"pluginKeys",value:t}),localStorage.setItem("pluginKeys",JSON.stringify(t))}else u({field:"pluginKeys",value:[...d,e]}),localStorage.setItem("pluginKeys",JSON.stringify([...d,e]))},C=e=>{let t=d.filter(t=>t.pluginId!==e.pluginId);if(0===t.length){u({field:"pluginKeys",value:[]}),localStorage.removeItem("pluginKeys");return}u({field:"pluginKeys",value:t}),localStorage.setItem("pluginKeys",JSON.stringify(t))},S=()=>{ec()},L=e=>{let{history:t,folders:l,prompts:s}=eu(e);u({field:"conversations",value:t}),u({field:"selectedConversation",value:t[t.length-1]}),u({field:"folders",value:l}),u({field:"prompts",value:s}),window.location.reload()},E=()=>{if(r&&r.length>0){var t,l;u({field:"selectedConversation",value:{id:(0,eJ.Z)(),name:e("New Conversation"),messages:[],model:r[0],prompt:(null===(t=eH.find(e=>{var t,l;return(null===(t=e.id)||void 0===t?void 0:t.toLowerCase())===(null===(l=r[0].name)||void 0===l?void 0:l.toLowerCase())}))||void 0===t?void 0:t.content)||"",promptState:(null===(l=eH.find(e=>{var t,l;return(null===(t=e.id)||void 0===t?void 0:t.toLowerCase())===(null===(l=r[0].name)||void 0===l?void 0:l.toLowerCase())}))||void 0===l?void 0:l.controlState)||0,temperature:h,folderId:null}})}u({field:"conversations",value:[]}),localStorage.removeItem("conversationHistory"),localStorage.removeItem("selectedConversation");let s=o.filter(e=>"chat"!==e.type);u({field:"folders",value:s}),j(s)},_=t=>{let s=l.filter(e=>e.id!==t.id);if(u({field:"conversations",value:s}),v({field:"searchTerm",value:""}),w(s),s.length>0)u({field:"selectedConversation",value:s[s.length-1]}),b(s[s.length-1]);else{if(r&&r.length>0){var a,n;u({field:"selectedConversation",value:{id:(0,eJ.Z)(),name:e("New Conversation"),messages:[],model:r[0],prompt:(null===(a=eH.find(e=>{var t,l;return(null===(t=e.id)||void 0===t?void 0:t.toLowerCase())===(null===(l=r[0].name)||void 0===l?void 0:l.toLowerCase())}))||void 0===a?void 0:a.content)||"",promptState:(null===(n=eH.find(e=>{var t,l;return(null===(t=e.id)||void 0===t?void 0:t.toLowerCase())===(null===(l=r[0].name)||void 0===l?void 0:l.toLowerCase())}))||void 0===n?void 0:n.controlState)||0,temperature:h,folderId:null}})}localStorage.removeItem("selectedConversation")}},P=()=>{u({field:"showChatbar",value:!s}),localStorage.setItem("showChatbar",JSON.stringify(!s))},A=e=>{if(e.dataTransfer){let t=JSON.parse(e.dataTransfer.getData("conversation"));p(t,{key:"folderId",value:0}),v({field:"searchTerm",value:""}),e.target.style.background="none"}};return(0,n.useEffect)(()=>{g?v({field:"filteredConversations",value:l.filter(e=>{let t=e.name.toLocaleLowerCase()+" "+e.messages.map(e=>e.content).join(" ");return t.toLowerCase().includes(g.toLowerCase())})}):v({field:"filteredConversations",value:l})},[g,l]),(0,a.jsx)(eg.Provider,{value:{...t,handleDeleteConversation:_,handleClearConversations:E,handleImportConversations:L,handleExportData:S,handlePluginKeyChange:k,handleClearPluginKey:C,handleApiChange:y,handleApiKeyChange:N},children:(0,a.jsx)(eK,{side:"left",isOpen:s,canCreateChat:r&&r.length>0,addItemButtonTitle:e("New chat"),itemComponent:(0,a.jsx)(eA,{conversations:f}),folderComponent:(0,a.jsx)(ev,{searchTerm:g}),items:f,searchTerm:g,handleSearchTerm:e=>v({field:"searchTerm",value:e}),toggleOpen:P,handleCreateItem:x,handleCreateFolder:()=>m(e("New folder"),"chat"),handleDrop:A,footerComponent:(0,a.jsx)(eP,{})})})},e$=e=>{let{selectedConversation:t,onNewConversation:l}=e;return(0,a.jsxs)("nav",{className:"flex w-full justify-between bg-[#fff] py-3 px-4 border-b border-[rgba(0,0,0,.08)]",children:[(0,a.jsx)("div",{className:"mr-4"}),(0,a.jsx)("div",{className:"max-w-[240px] overflow-hidden text-ellipsis whitespace-nowrap text-[#322221]",children:t.name}),(0,a.jsx)(eT.Z,{className:"cursor-pointer hover:text-neutral-400 mr-8",onClick:l})]})},eW={api:"..",apiKey:"",loading:!1,pluginKeys:[],lightMode:"dark",isStream:!0,messageIsStreaming:!1,modelError:null,models:[],folders:[],conversations:[],selectedConversation:void 0,currentMessage:void 0,prompts:[],temperature:1,showPromptbar:!0,showChatbar:!0,currentFolder:void 0,messageError:!1,searchTerm:"",defaultModelId:void 0,serverSideApiKeyIsSet:!1,serverSidePluginKeysSet:!1},eY=e=>{let{serverSideApiKeyIsSet:t,serverSidePluginKeysSet:l,defaultModelId:s}=e,{t:r}=(0,i.$G)("chat"),{getModels:o}=m(),u=c({initialState:eW}),{state:{api:x,apiKey:p,lightMode:N,folders:C,conversations:S,selectedConversation:L,prompts:E,modelError:_,models:P},dispatch:A}=u,T=(0,n.useRef)(!1),z=async()=>{try{let e=await o({url:x,key:p});A&&A({field:"models",value:e})}catch(e){A&&!_&&A({field:"modelError",value:{code:"500",title:"false",messageLines:[]}}),console.log(e)}};(0,n.useEffect)(()=>{P&&(!S||S&&0===S.length)&&R&&R()},[P]),(0,n.useEffect)(()=>{x&&z()},[x]);let D=e=>{A({field:"selectedConversation",value:e}),b(e)},O=async(e,t)=>{let l={id:(0,eJ.Z)(),name:e,type:t},s=[...C,l];A({field:"folders",value:s}),j(s)},F=e=>{let t=C.filter(t=>t.id!==e);A({field:"folders",value:t}),j(t);let l=S.map(t=>t.folderId===e?{...t,folderId:null}:t);A({field:"conversations",value:l}),w(l);let s=E.map(t=>t.folderId===e?{...t,folderId:null}:t);A({field:"prompts",value:s}),y(s)},Z=(e,t)=>{let l=C.map(l=>l.id===e?{...l,name:t}:l);A({field:"folders",value:l}),j(l)},R=async()=>{let e;await z();let t=S[S.length-1];if(P&&P.length>0){var l,s,a;await fetch("/config_pub.json").then(e=>e.json()).then(t=>{e=t.system_prompt}).catch(e=>console.error("Error fetching JSON:",e));let n={id:(0,eJ.Z)(),name:r("New Conversation"),messages:[],model:(null==t?void 0:t.model)&&function(e,t){for(let l of e)if(l.id===t.id)return!0;return!1}(P,null==t?void 0:t.model)&&(null==t?void 0:t.model)||P[0],prompt:e||(null===(l=eH.find(e=>{var t,l;return(null===(t=e.id)||void 0===t?void 0:t.toLowerCase())===(null===(l=P[0].name)||void 0===l?void 0:l.toLowerCase())}))||void 0===l?void 0:l.content)||"",promptState:(null===(s=eH.find(e=>{var t,l;return(null===(t=e.id)||void 0===t?void 0:t.toLowerCase())===(null===(l=P[0].name)||void 0===l?void 0:l.toLowerCase())}))||void 0===s?void 0:s.controlState)||0,temperature:null!==(a=null==t?void 0:t.temperature)&&void 0!==a?a:h,folderId:null},i=[...S,n];A({field:"selectedConversation",value:n}),A({field:"conversations",value:i}),b(n),w(i),A({field:"loading",value:!1})}},G=(e,t)=>{let l={...e,[t.key]:t.value},{single:s,all:r}=v(l,S);A({field:"selectedConversation",value:s}),A({field:"conversations",value:r})},M=(e,t)=>{let l=Object.assign(e);t.forEach(e=>{l[e.key]=e.value});let{single:s,all:r}=v(l,S);A({field:"selectedConversation",value:s}),A({field:"conversations",value:r})};return(0,n.useEffect)(()=>{window.innerWidth<640&&A({field:"showChatbar",value:!1})},[L]),(0,n.useEffect)(()=>{t&&A({field:"serverSideApiKeyIsSet",value:t}),l&&A({field:"serverSidePluginKeysSet",value:l})},[t,l]),(0,n.useEffect)(()=>{var e,s,a,n,i;let o=k();o.theme&&A({field:"lightMode",value:o.theme}),o.isStream&&A({field:"isStream",value:o.isStream});let d=localStorage.getItem("api"),c=localStorage.getItem("apiKey");t?(A({field:"apiKey",value:""}),localStorage.removeItem("apiKey")):c&&A({field:"apiKey",value:c}),d&&A({field:"api",value:d});let u=localStorage.getItem("pluginKeys");l?(A({field:"pluginKeys",value:[]}),localStorage.removeItem("pluginKeys")):u&&A({field:"pluginKeys",value:u}),window.innerWidth<640&&A({field:"showChatbar",value:!1});let m=localStorage.getItem("showChatbar");m&&A({field:"showChatbar",value:"true"===m});let x=localStorage.getItem("folders");x&&A({field:"folders",value:JSON.parse(x)});let p=localStorage.getItem("prompts");p&&A({field:"prompts",value:JSON.parse(p)});let v=localStorage.getItem("conversationHistory");if(v){let e=JSON.parse(v),t=f(e);A({field:"conversations",value:t})}let b=localStorage.getItem("selectedConversation");if(b){let t=JSON.parse(b),l=g(t);if(l.model&&P&&P.length>0){let t=P.filter(e=>e.id===l.model.id);t&&0!==t.length||(l.model=P[0],l.prompt=(null===(e=eH.find(e=>{var t,l,s;return(null===(t=e.id)||void 0===t?void 0:t.toLowerCase())===(null===(l=P[0])||void 0===l?void 0:null===(s=l.name)||void 0===s?void 0:s.toLowerCase())}))||void 0===e?void 0:e.content)||"",l.promptState=(null===(s=eH.find(e=>{var t,l,s;return(null===(t=e.id)||void 0===t?void 0:t.toLowerCase())===(null===(l=P[0])||void 0===l?void 0:null===(s=l.name)||void 0===s?void 0:s.toLowerCase())}))||void 0===s?void 0:s.controlState)||0)}A({field:"selectedConversation",value:l})}else{let e=S[S.length-1],t={id:(0,eJ.Z)(),name:r("New Conversation"),messages:[],temperature:null!==(a=null==e?void 0:e.temperature)&&void 0!==a?a:h,folderId:null};P&&P.length>0&&(t.model=P[0],t.prompt=(null===(n=eH.find(e=>{var t,l,s;return(null===(t=e.id)||void 0===t?void 0:t.toLowerCase())===(null===(l=P[0])||void 0===l?void 0:null===(s=l.name)||void 0===s?void 0:s.toLowerCase())}))||void 0===n?void 0:n.content)||"",t.promptState=(null===(i=eH.find(e=>{var t,l,s;return(null===(t=e.id)||void 0===t?void 0:t.toLowerCase())===(null===(l=P[0])||void 0===l?void 0:null===(s=l.name)||void 0===s?void 0:s.toLowerCase())}))||void 0===i?void 0:i.controlState)||0),A({field:"selectedConversation",value:t})}},[A,P,t,l]),(0,a.jsxs)(I.Provider,{value:{...u,handleNewConversation:R,handleCreateFolder:O,handleDeleteFolder:F,handleUpdateFolder:Z,handleSelectConversation:D,handleUpdateConversation:G,handleUpdateConversationAll:M},children:[(0,a.jsxs)(d(),{children:[(0,a.jsx)("title",{children:"GaiaNet"}),(0,a.jsx)("meta",{name:"description",content:"ChatGPT but better."}),(0,a.jsx)("meta",{name:"viewport",content:"height=device-height ,width=device-width, initial-scale=1, user-scalable=no"}),(0,a.jsx)("link",{rel:"icon",href:"./favicon.png"})]}),L&&(0,a.jsxs)("main",{className:"flex h-screen w-screen flex-col text-sm text-white dark:text-white ".concat(N),children:[(0,a.jsx)("div",{className:"fixed top-0 w-full sm:hidden ",children:(0,a.jsx)(e$,{selectedConversation:L,onNewConversation:R})}),(0,a.jsxs)("div",{className:"flex h-full w-full pt-[49px] sm:pt-0",children:[(0,a.jsx)(eB,{}),(0,a.jsx)("div",{className:"flex flex-1",children:(0,a.jsx)(ed,{stopConversationRef:T})})]})]})]})};var eV=eY,eX=!0}},function(e){e.O(0,[879,597,774,888,179],function(){return e(e.s=48312)}),_N_E=e.O()}]);